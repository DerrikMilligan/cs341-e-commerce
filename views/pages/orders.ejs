<%- include('../partials/header.ejs') %>

<div class="container cart products">
	<div class="row mb-3 d-flex justify-content-center">
		<div class="col-11">
			<div class="row mb-3">
				<h3>Past Orders</h3>
			</div>
			<div class="row d-flex justify-content-center">
				<div class="col-12">
					<table class="table table-hover table-bordered table-light">
						<thead>
							<tr>
								<th scope="col"></th>
								<th scope="col">Date Ordered</th>
								<th scope="col">Total</th>
							</tr>
						</thead>
						<tbody>
							<% orders.forEach((order) => { %>
								<tr>
									<td style="width: 200px;">
										<a href="/cart/history/<%= order._id %>">
											<button class="btn btn-success">View Order Details</button>
										</a>
									</td>
									<td class="align-middle"><%= (new Date(order.order_timestamp)).toLocaleDateString() %></td>
									<td class="align-middle">
										$<%=
											order.items.reduce((acc, cartItem) => {
												acc += (cartItem.product.price * cartItem.quantity);
												return acc;
											}, 0);
										%>
									</td>
								</tr>
							<% }) %>
						</tbody>
					</table>
				</div>
			</div>
		</div>
	</div>
</div>

<%- include('../partials/footer.ejs') %>
